<!doctype html>
<html lang="zh-cn">
<head>
 	<base href="<?php echo base_url();?>" />
	<meta charset="UTF-8">
	<meta name="viewport" content="initial-scale=1, maximum-scale=3, minimum-scale=1, user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes" /> 
	<meta name="format-detection" content="telephone=no" /> 
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  	<meta http-equiv="x-rim-auto-match" content="none" />
  	<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
	<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache"> 
	<META HTTP-EQUIV="Expires" CONTENT="0"> 
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<title>视频</title>
	<link rel="stylesheet" href="css/style.css" />
	<link rel="stylesheet" href="css/dropload.css">
	<script type="text/javascript" src="js/alert.js"></script>
	<script type="text/javascript" src="js/zepto.js"></script>
	<script type="text/javascript" src="js/dropload.min.js"></script>
    <style>
*{margin:0;padding:0;-webkit-tap-highlight-color:transparent;-webkit-text-size-adjust:none;}
html{font-size:10px;}
body{background-color:#f5f5f5;font-size:1.2em;}
.tab{height:44px;background-color:#eee;line-height:44px;}
.tab .item{display:inline-block;width:17%;color:#333;text-align:center;text-decoration:none;font-size:14px;}
.tab .cur{height:42px;border-bottom:2px solid #1480D1;color:#1480D1;}
.content{background-color:#fff;}
.content .item{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:3.125%;border-bottom:1px solid #ddd;color:#333;text-decoration:none;-ms-flex-align:center;-webkit-box-align:center;box-align:center;-webkit-align-items:center;align-items:center;}
.content .item img{float:left;width:25%;border:1px solid #ddd;}
.right{float:left;margin-left:4%;width:64%;}
.right p{display:-webkit-box;overflow:hidden;margin-top:2%;-webkit-line-clamp:3;-webkit-box-orient:vertical;word-break:break-word;}
.content .item h3{overflow:hidden;margin:0 10px;width:100%;max-height:40px;font-size:1.5rem;line-height:20px;}
.content .item .date{display:block;height:20px;color:#999;line-height:20px;}
.opacity{-webkit-animation:opacity .3s linear;animation:opacity .3s linear;}
@-webkit-keyframes opacity{0%{opacity:0;}
100%{opacity:1;}
}
@keyframes opacity{0%{opacity:0;}
100%{opacity:1;}
}
@media screen and (min-width:320px) and (max-width:344px){.tab .item{font-size:12px;}
}
@media screen and (min-width:345px) and (max-width:370px){.tab .item{font-size:13px;}
}
@media screen and (min-width:310px) and (max-width:375px){img{height:75px;}
}
@media screen and (min-width:376px) and (max-width:414px){img{height:80px;}
}
@media screen and (min-width:415px) and (max-width:639px){img{height:90px;}
}
@media screen and (min-width:640px) and (max-width:719px){img{height:110px;}
}
@media screen and (min-width:720px) and (max-width:749px){img{height:165px;}
}
@media screen and (min-width:750px) and (max-width:799px){img{height:180px;}
}
@media screen and (min-width:800px)and (max-width:1023px){img{height:190px;}
}
@media screen and (min-width:1024px)and (max-width:1920px){img{height:200px;}
}

    </style>
</head>
<body>
<div class="tab">
    <a href="javascript:;" class="item cur" style="margin-left: 2%">穿越糖潮</a>
    <a href="javascript:;" class="item">产品介绍</a>
    <a href="javascript:;" class="item">使用教程</a>
    <a href="javascript:;" class="item">专家推荐</a>
    <a href="javascript:;" class="item" style="width: 12%;">新闻</a>
    <a href="javascript:;" class="item" style="width: 12%;">其他</a>
</div>
<div class="content">
    <div class="lists"></div>
    <div class="lists"></div>
    <div class="lists"></div>
    <div class="lists"></div>
    <div class="lists"></div>
    <div class="lists"></div>
</div>
<script>
$(function(){
    var itemIndex = 0;
    var tab1LoadEnd = false;
    var tab2LoadEnd = false;
    var tab3LoadEnd = false;
    var tab4LoadEnd = false;
    var tab5LoadEnd = false;
    var tab6LoadEnd = false;
    var downloads_url = "<?php echo isset($download_url)?$download_url:'';?>";
    // tab
    $('.tab .item').on('click',function(){
        var $this = $(this);
        itemIndex = $this.index();
        $this.addClass('cur').siblings('.item').removeClass('cur');
        $('.lists').eq(itemIndex).show().siblings('.lists').hide();
        // 如果选中菜单一
        if(itemIndex == '0'){
            // 如果数据没有加载完
            if(!tab1LoadEnd){
                // 解锁
                dropload.unlock();
                dropload.noData(false);
            }else{
                // 锁定
                dropload.lock('down');
                dropload.noData();
            }
        // 如果选中菜单二
        }else if(itemIndex == '1'){
            if(!tab2LoadEnd){
                // 解锁
                dropload.unlock();
                dropload.noData(false);
            }else{
                // 锁定
                dropload.lock('down');
                dropload.noData();
            }
        }else if(itemIndex == '2'){
            if(!tab3LoadEnd){
                // 解锁
                dropload.unlock();
                dropload.noData(false);
            }else{
                // 锁定
                dropload.lock('down');
                dropload.noData();
            }
        }else if(itemIndex == '3'){
            if(!tab4LoadEnd){
                // 解锁
                dropload.unlock();
                dropload.noData(false);
            }else{
                // 锁定
                dropload.lock('down');
                dropload.noData();
            }
        }else if(itemIndex == '4'){
            if(!tab5LoadEnd){
                // 解锁
                dropload.unlock();
                dropload.noData(false);
            }else{
                // 锁定
                dropload.lock('down');
                dropload.noData();
            }
        }else if(itemIndex == '5'){
            if(!tab6LoadEnd){
                // 解锁
                dropload.unlock();
                dropload.noData(false);
            }else{
                // 锁定
                dropload.lock('down');
                dropload.noData();
            }
        }
        // 重置
        dropload.resetload();
    });
    var page1= 1;
    var page2= 1;
    var page3= 1;
    var page4= 1;
    var page5= 1;
    var page6= 1;
    var sum_size = "<?php echo isset($total)?$total:'0';?>";
    console.log(sum_size)
	var page_all = Math.ceil(sum_size/8);
    // 每页展示4个
    var num = 8;
    var pageStart = 0,pageEnd = 0;
    // dropload
    var dropload = $('.content').dropload({
        scrollArea : window,
        loadDownFn : function(me){
            // 加载菜单一的数据
            if(itemIndex == '0'){
                $.ajax({
                    type: 'GET',
                    url:'videos/getVideosList',
 					data:{status:1,page:page1},
                    dataType: 'json',
                    success: function(data){
                    	console.log(data.info)
                        var result = '';
                       	page1++;
                       	if(data.result_code == '200'){
                       		for(var i = 0; i < data.info.length; i++){
                            	result+="<a class='item opacity' href='"+data.info[i].url+"'><img src='"+downloads_url+"videos/"+data.info[i].images+"'><div class='right'><h3>"+data.info[i].title+"</h3><p>"+data.info[i].remark+"</p></div></a>"; 
                        	}
                       	}
                        if( data.result_code == '400' ){
	 						// 数据加载完
                               tab1LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
	 					if( data.result_code == '200' && data.info==''){
	 						// 数据加载完
                               tab1LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
                         if(page1 >page_all){
                                    // 数据加载完
                                tab1LoadEnd = true;
                                    // 锁定
                                me.lock();
                                 // 无数据
                                me.noData();
                        }
                            // 为了测试，延迟1秒加载
                            setTimeout(function(){
                                $('.lists').eq(0).append(result);
                                // 每次数据加载完，必须重置
                                me.resetload();
                            },1000);
                        
                    },
                    error: function(xhr, type){
                        alert('Ajax error!');
                        // 即使加载出错，也得重置
                        me.resetload();
                    }
                });
            // 加载菜单二的数据
            }else if(itemIndex == '1'){
                $.ajax({
                    type: 'GET',
                    url:'videos/getVideosList',
 					data:{status:2,page:page2},
                    dataType: 'json',
                    success: function(data){
                        var result = '';
                        page2++;
                        if(data.result_code == '200'){
                        	for(var i = 0; i < data.info.length; i++){
                            	result+="<a class='item opacity' href='"+data.info[i].url+"'><img src='"+downloads_url+"videos/"+data.info[i].images+"'><div class='right'><h3>"+data.info[i].title+"</h3><p>"+data.info[i].remark+"</p></div></a>";
                        	}
                        }
                        if( data.result_code == '400' ){
	 						// 数据加载完
                               tab2LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
	 					if( data.result_code == '200' && data.info==''){
	 						// 数据加载完
                               tab2LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
                        if(page2 >= page_all){
                               // 数据加载完
                               tab2LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
                        }
                        // 为了测试，延迟1秒加载
                        setTimeout(function(){
                            $('.lists').eq(1).append(result);
                            // 每次数据加载完，必须重置
                            me.resetload();
                        },1000);
                    },
                    error: function(xhr, type){
                        showPopUpDiv();
                		getAlert({
                    		text:"内容获取失败",
                    		alert:0
                    	});
                        // 即使加载出错，也得重置
                        me.resetload();
                    }
                });
            }else if(itemIndex == '2'){
                $.ajax({
                    type: 'GET',
                    url:'videos/getVideosList',
 					data:{status:3,page:page3},
                    dataType: 'json',
                    success: function(data){
                        var result = '';
                        page3++;
                        if(data.result_code == '200'){
                        	for(var i = 0; i < data.info.length; i++){
                            	result+="<a class='item opacity' href='"+data.info[i].url+"'><img src='"+downloads_url+"videos/"+data.info[i].images+"'><div class='right'><h3>"+data.info[i].title+"</h3><p>"+data.info[i].remark+"</p></div></a>";
                        	}
                        }
                        if( data.result_code == '400' ){
	 						// 数据加载完
                               tab3LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
	 					if( data.result_code == '200' && data.info==''){
	 						// 数据加载完
                               tab3LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
                        if(page3 >= page_all){
                                 // 数据加载完
                            tab3LoadEnd = true;
                                // 锁定
                            me.lock();
                               // 无数据
                            me.noData();
                        }
                        // 为了测试，延迟1秒加载
                        setTimeout(function(){
                            $('.lists').eq(2).append(result);
                            // 每次数据加载完，必须重置
                            me.resetload();
                        },1000);
                    },
                    error: function(xhr, type){
                        showPopUpDiv();
	                	getAlert({
	                    	text:"内容获取失败",
	                    	alert:0
	                    });
                        // 即使加载出错，也得重置
                        me.resetload();
                    }
                });
            }else if(itemIndex == '3'){
                $.ajax({
                    type: 'GET',
                    url:'videos/getVideosList',
 					data:{status:4,page:page4},
                    dataType: 'json',
                    success: function(data){
                        var result = '';
                        page4++;
                        if(data.result_code == '200'){
                        	for(var i = 0; i < data.info.length; i++){
                                result+="<a class='item opacity' href='"+data.info[i].url+"'><img src='"+downloads_url+"videos/"+data.info[i].images+"'><div class='right'><h3>"+data.info[i].title+"</h3><p>"+data.info[i].remark+"</p></div></a>";
                        	}
                        }
                        if( data.result_code == '400' ){
	 						// 数据加载完
                               tab4LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
	 					if( data.result_code == '200' && data.info==''){
	 						// 数据加载完
                               tab4LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
                       if(page4 >= page_all){
                              // 数据加载完
                            tab4LoadEnd = true;
                              // 锁定
                            me.lock();
                              // 无数据
                            me.noData();
                        
                        }
                        // 为了测试，延迟1秒加载
                        setTimeout(function(){
                            $('.lists').eq(3).append(result);
                            // 每次数据加载完，必须重置
                            me.resetload();
                        },1000);
                    },
                    error: function(xhr, type){
                         showPopUpDiv();
	                	getAlert({
	                    	text:"内容获取失败",
	                    	alert:0
	                    });
                        // 即使加载出错，也得重置
                        me.resetload();
                    }
                });
            }else if(itemIndex == '4'){
                $.ajax({
                    type: 'GET',
                    url:'videos/getVideosList',
 					data:{status:5,page:page5},
                    dataType: 'json',
                    success: function(data){
                        var result = '';
                        page5++;
                        if(data.result_code == '200'){
                        	for(var i = 0; i < data.info.length; i++){
                            result+="<a class='item opacity' href='"+data.info[i].url+"'><img src='"+downloads_url+"videos/"+data.info[i].images+"'><div class='right'><h3>"+data.info[i].title+"</h3><p>"+data.info[i].remark+"</p></div></a>";
                        }
                        }
                        if( data.result_code == '400' ){
	 						// 数据加载完
                               tab5LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
	 					if( data.result_code == '200' && data.info==''){
	 						// 数据加载完
                               tab5LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
                        if(page5 >= page_all){
                           // 数据加载完
                            tab5LoadEnd = true;
                             // 锁定
                            me.lock();
                              // 无数据
                            me.noData();
                        }
                        // 为了测试，延迟1秒加载
                        setTimeout(function(){
                            $('.lists').eq(4).append(result);
                            // 每次数据加载完，必须重置
                            me.resetload();
                        },1000);
                    },
                    error: function(xhr, type){
                        showPopUpDiv();
	                	getAlert({
	                    	text:"内容获取失败",
	                    	alert:0
	                    });
                        // 即使加载出错，也得重置
                        me.resetload();
                    }
                });
            }else if(itemIndex == '5'){
                $.ajax({
                    type: 'GET',
                    url:'videos/getVideosList',
 					data:{status:6,page:page6},
                    dataType: 'json',
                    success: function(data){
                        var result = '';
                        page6++;
                        if(data.result_code == '200'){
                        	for(var i = 0; i < data.info.length; i++){
                           	 	result+="<a class='item opacity' href='"+data.info[i].url+"'><img src='"+downloads_url+"videos/"+data.info[i].images+"'><div class='right'><h3>"+data.info[i].title+"</h3><p>"+data.info[i].remark+"</p></div></a>";
                        	}
                        }
                        if( data.result_code == '400' ){
	 						// 数据加载完
                               tab6LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
	 					if( data.result_code == '200' && data.info==''){
	 						// 数据加载完
                               tab6LoadEnd = true;
                               // 锁定
                               me.lock();
                                 // 无数据
                               me.noData();
	 					}
                        if(page6 >= page_all){
                               // 数据加载完
                        	tab6LoadEnd = true;
                                // 锁定
                            me.lock();
                                // 无数据
                            me.noData();
                                }
                        // 为了测试，延迟1秒加载
                        setTimeout(function(){
                            $('.lists').eq(5).append(result);
                            // 每次数据加载完，必须重置
                            me.resetload();
                        },1000);
                    },
                    error: function(xhr, type){
                         showPopUpDiv();
	                	getAlert({
	                    	text:"内容获取失败",
	                    	alert:0
	                    });
                        // 即使加载出错，也得重置
                        me.resetload();
                    }
                });
            }
        }
    });
});
</script>
<script>
	function detail(redirect_url){
		location.href=redirect_url;
	}
</script>
</body>
</html>